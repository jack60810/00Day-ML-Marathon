---
title: "Compare two group"
author: "Jack Tsai"
date: "2019-4-16"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Read Data and see the sample and summary

利用 data.table 套件讀入資料，並對資料進行敘述統計

```{r}
library(data.table)
data = fread('file:///E:/goodnight work/20190416 compare two group/kr_star_free_match count comparison_2019_04_16.csv')
data$variant = as.factor(as.character(data$variant))
summary(data)
```



## 對分組資料看敘述統計
兩組做比較，且count為一個非常偏態的分配，須對資料進行整理。

```{r, echo=FALSE}
library(ggplot2)
qplot(x = as.factor(variant), y = count, data = data, geom = "boxplot")
```


```{r}
group1 = data[data$variant == 0]
group2 = data[data$variant == 1]
summary(group1)
summary(group2)

library(dplyr)
group1_stat = group1 %>% mutate(mean = mean(count),min = mean -1.5 * sd(count),max = mean + 1.5 * sd(count) ) %>% filter(count > min & count < max)

group2_stat = group2 %>% mutate(mean = mean(count),min = mean -1.5 * sd(count),max = mean + 1.5 * sd(count) ) %>% filter(count > min & count < max)
summary(group1_stat)
summary(group2_stat)
```


## 檢定變異數

```{r}
var.test(group1_stat$count,group2_stat$count)
```

Reject H0:兩組變異數不相等

## 檢定x(0)組別是否小於y(1)組別

```{r}
t.test(group1_stat$count,group2_stat$count,var.equal = F,alternative = 'less', ,conf.level = 0.95)
```

在顯著水準0.05下拒絕H0，95%的信賴區間 -Inf ~ -0.1838 ，H0 muX <= muY，X組別也就是組別0，平均數雖然較小，卻無法證明第一個組別顯著小於組別1

## 檢定x(0)組別是否相等y(1)組別
```{r}
t.test(group1_stat$count,group2_stat$count,var.equal = F,alternative = 'two.side', conf.level = 0.95)
t.test(group1_stat$count,group2_stat$count,var.equal = F,alternative = 'two.side', conf.level = 0.9)
```

在顯著水準0.05下不拒絕H0，但在顯著水準 0.10 下拒絕H0，H0 muX = muY，X組別也就是組別0，平均數雖然較小，在相對寬鬆的條件下才能證明此兩組不相等

## 中位數檢定

因兩組分配太過偏態，使用中位數檢定來做分析，但中位數檢定因為為無母樹統計，會相對有母數檢定力較低。

```{r}
wilcox.test(group1_stat$count,group2_stat$count, "two.sided",exact = F)
```

由Wilcox rank sum test 得到，兩組中位數並沒有顯著差異，此功能實驗組與對照組並沒有顯著差異！